<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta name="theme-color" content="#000000"/><link rel="icon" href="/static/images/favicon.ico"/><link rel="apple-touch-icon" href="/static/images/logo192.png"/><link rel="stylesheet" href="/static/lib/simplemde.min.css"><script async src="https://www.googletagmanager.com/gtag/js?id=G-0L4WRG1D3N"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0L4WRG1D3N")</script><title>ES知识点记录 | bill-lai 的博客</title><link href="/static/css/main.8f23dd88.chunk.css" rel="stylesheet"></head><body><input placeholder=""><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="style_app__1yczT"><header class="style_slide__z5PNT style_slide__3Yi3e"><a href="/"><img src="/static/media/portrait.df7a5375.jpg" class="style_portrait__2GrBh" alt="portrait"/></a><div class="style_content__3GlZB"><div class="style_introduce__2UxnL"><h1><a href="/">bill-lai</a></h1><p>专注 WEB 端开发</p></div><ul class="style_navs__2yN9I"><li><a href="/">首页</a></li><li><a href="/archive">专题</a></li><li><a href="/special">归档</a></li></ul></div></header><div class="style_body__3Yz5T"><div class="style_layer__1ZQZt"><div class="style_main__XnHDF"><div> <h1 class="main-title">ES知识点记录<span class="marker">2022-03-22 15:17</span></h1><div class="marked-body"><div><h2 id="es6">ES6</h2>
<h3 id="intl">Intl</h3>
<p>对象是 ECMAScript 国际化 API 的一个命名空间，它提供了精确的字符串对比、数字格式化，和日期时间格式化。</p>
<p>日期格式化</p>
<pre><code class="language-js"><span class="token comment">// 例如我们希望出现的日期信息格式是：“xxxx年xx月xx日 xx:xx:xx”。</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>DateTimeFormat</span><span class="token punctuation">(</span><span class="token string">"zh"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">year</span><span class="token operator">:</span> <span class="token string">"numeric"</span><span class="token punctuation">,</span>
  <span class="token comment">/* 
        '2-digit'表示一定使用2位数字表示，
        因此，如果数值不超过10，会自动在前面加0
  */</span>
  <span class="token literal-property property">month</span><span class="token operator">:</span> <span class="token string">"2-digit"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">day</span><span class="token operator">:</span> <span class="token string">"2-digit"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">hour</span><span class="token operator">:</span> <span class="token string">"2-digit"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">minute</span><span class="token operator">:</span> <span class="token string">"2-digit"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">second</span><span class="token operator">:</span> <span class="token string">"2-digit"</span><span class="token punctuation">,</span>
  <span class="token comment">// 设置为false表示我们采用24小时制</span>
  <span class="token literal-property property">hour12</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// IE11浏览器下的效果 完全符合我们的预期， - 2021年05月29日 10:15:27</span>
<span class="token comment">// 但是在Chrome浏览器和Firefox浏览器下，却不是中文的年月日而是斜杠-2021/05/29 10:15:27， 还需要进一步字符处理下</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>数字格式化，</p>
<pre><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token number">12345.6789</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果是："12,345.679"</span>

<span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token keyword nil">undefined</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">minimumIntegerDigits</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果是："08"</span>

<span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">"zh"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">"currency"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">currency</span><span class="token operator">:</span> <span class="token string">"CNY"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">currencyDisplay</span><span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token number">12345.6789</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果是："12,345.68 人民币"</span>

<span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">"zh"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">"currency"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">currency</span><span class="token operator">:</span> <span class="token string">"CNY"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token number">12345.6789</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果是："￥12,345.68 "</span>

<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">星期</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">"zh-Hans-CN-u-nu-hanidec"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span>
  <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">getDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token comment">// 结果是："星期五"</span>
</code></pre>
<h3 id="判断是否在模块中">判断是否在模块中</h3>
<p>模块中顶层的 this 等于 undefined</p>
<pre><code class="language-js"><span class="token keyword">const</span> isModuleScript <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token operator">===</span> <span class="token keyword nil">undefined</span>
</code></pre>
<h3 id="numberepsilon">Number.EPSILON</h3>
<p>Number.EPSILON 属性表示 1 与Number可表示的大于 1 的最小的浮点数之间的差值。</p>
<p>判断数值是否相等</p>
<pre><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">isEqual</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> origin</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">abs</span><span class="token punctuation">(</span>origin <span class="token operator">-</span> target<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token known-class-name class-name">Number</span><span class="token punctuation">.</span><span class="token constant">EPSILON</span>
</code></pre>
<h3 id="mathhypot">Math.hypot</h3>
<p>计算两数平方开方<code>Math.hypot(3,4) === 5</code></p>
<h2 id="es7">ES7</h2>
<h3 id="求幂运算符">求幂运算符</h3>
<pre><code class="language-js"><span class="token comment">// 2的平方</span>
<span class="token keyword">let</span> squared <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">// same as: 2 * 2   Math.Pow(2,2)</span>

<span class="token comment">// 2的三次方</span>
<span class="token keyword">let</span> cubed <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">// same as: 2 * 2 * 2   Math.Pow(2,3)</span>
</code></pre>
<h2 id="es8">ES8</h2>
<h3 id="string-padding">String padding</h3>
<p>如果某个字符串不够指定长度，会在头部或尾部补全。padStart()用于头部补全，padEnd()用于尾部补全。</p>
<pre><code class="language-js"><span class="token string">"1"</span><span class="token punctuation">.</span><span class="token method function property-access">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "0000000001"</span>
<span class="token string">"12"</span><span class="token punctuation">.</span><span class="token method function property-access">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "0000000012"</span>
<span class="token string">"123456"</span><span class="token punctuation">.</span><span class="token method function property-access">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "0000123456"</span>

<span class="token comment">// 格式提示</span>
<span class="token string">"12"</span><span class="token punctuation">.</span><span class="token method function property-access">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"YYYY-MM-DD"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "YYYY-MM-12"</span>
<span class="token string">"09-12"</span><span class="token punctuation">.</span><span class="token method function property-access">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"YYYY-MM-DD"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "YYYY-09-12"</span>
</code></pre>
<h3 id="objectgetownproperdescriptors">Object.getOwnProperDescriptors</h3>
<pre><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">shallowClone</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">object</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span>
  <span class="token comment">// 创建一个新对象</span>
  <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span>
    <span class="token comment">// 返回指定对象的原型</span>
    <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">getPrototypeOf</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 返回指定对象所有自身属性</span>
    <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 或者</span>
<span class="token keyword">const</span> <span class="token function-variable function">shallowMerge</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> source</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span>
  <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">defineProperties</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="atomics">Atomics</h3>
<p>Atomics 对象提供了一组静态方法对 SharedArrayBuffer 和 ArrayBuffer 对象进行原子操作。多线程之间操作数据不会引起混乱的api</p>
<h2 id="es9">ES9</h2>
<h3 id="u-修饰符">u 修饰符</h3>
<p>ES6 对正则表达式添加了u修饰符，含义为“Unicode 模式”，用来正确处理大于\uFFFF的 Unicode 字符。也就是说，会正确处理四个字节的 UTF-16 编码。</p>
<pre><code class="language-js"><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\uD83D</span><span class="token regex-delimiter">/</span><span class="token regex-flags">u</span></span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'\uD83D\uDC2A'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span><span class="token operator">^</span>\uD83D<span class="token operator">/</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'\uD83D\uDC2A'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

<span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">'𠮷'</span><span class="token punctuation">;</span>

<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^.$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span><span class="token operator">^</span><span class="token punctuation">.</span><span class="token property-access">$</span><span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// true</span>

<span class="token comment">// 新增大括号在u模式下标识一个字符 内放置16进制数</span>
<span class="token operator">/</span>\u<span class="token punctuation">{</span><span class="token number">61</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span>\u<span class="token punctuation">{</span><span class="token number">61</span><span class="token punctuation">}</span><span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token operator">/</span>\u<span class="token punctuation">{</span>20BB7<span class="token punctuation">}</span><span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'𠮷'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

<span class="token operator">/</span>a<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'aa'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token operator">/</span>a<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'aa'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token operator">/</span>𠮷<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'𠮷𠮷'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span>𠮷<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'𠮷𠮷'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

<span class="token operator">/</span><span class="token operator">^</span>\<span class="token constant">S</span>$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'𠮷'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token operator">/</span><span class="token operator">^</span>\<span class="token constant">S</span>$<span class="token operator">/</span>u<span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'𠮷'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

<span class="token keyword">function</span> <span class="token function">codePointLength</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\s\S]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gu</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> result <span class="token operator">?</span> result<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">'𠮷𠮷'</span><span class="token punctuation">;</span>

s<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token comment">// 4</span>
<span class="token function">codePointLength</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// 2</span>
</code></pre>
<h3 id="y修饰符">y修饰符</h3>
<p>除了u修饰符，ES6 还为正则表达式添加了y修饰符，叫做“粘连”（sticky）修饰符。</p>
<pre><code class="language-js"><span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">'aaa_aa_a'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> r1 <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token keyword">var</span> r2 <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">y</span></span><span class="token punctuation">;</span>

r1<span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// ["aaa"]</span>
r2<span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// ["aaa"]</span>

r1<span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// ["aa"]</span>
r2<span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// null</span>

<span class="token keyword">const</span> <span class="token constant">REGEX</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a</span><span class="token regex-delimiter">/</span><span class="token regex-flags">y</span></span><span class="token punctuation">;</span>

<span class="token comment">// 指定从2号位置开始匹配</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span><span class="token property-access">lastIndex</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">// 不是粘连，匹配失败</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span><span class="token string">'xaya'</span><span class="token punctuation">)</span> <span class="token comment">// null</span>

<span class="token comment">// 指定从3号位置开始匹配</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span><span class="token property-access">lastIndex</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">// 3号位置是粘连，匹配成功</span>
<span class="token keyword">const</span> match <span class="token operator">=</span> <span class="token constant">REGEX</span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span><span class="token string">'xaya'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
match<span class="token punctuation">.</span><span class="token property-access">index</span> <span class="token comment">// 3</span>
<span class="token constant">REGEX</span><span class="token punctuation">.</span><span class="token property-access">lastIndex</span> <span class="token comment">// 4</span>

<span class="token keyword">const</span> <span class="token constant">TOKEN_Y</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\s*(\+|[0-9]+)\s*</span><span class="token regex-delimiter">/</span><span class="token regex-flags">y</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">TOKEN_G</span>  <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\s*(\+|[0-9]+)\s*</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>

<span class="token function">tokenize</span><span class="token punctuation">(</span><span class="token constant">TOKEN_Y</span><span class="token punctuation">,</span> <span class="token string">'3 + 4'</span><span class="token punctuation">)</span>
<span class="token comment">// [ '3', '+', '4' ]</span>
<span class="token function">tokenize</span><span class="token punctuation">(</span><span class="token constant">TOKEN_G</span><span class="token punctuation">,</span> <span class="token string">'3 + 4'</span><span class="token punctuation">)</span>
<span class="token comment">// [ '3', '+', '4' ]</span>

<span class="token function">tokenize</span><span class="token punctuation">(</span><span class="token constant">TOKEN_Y</span><span class="token punctuation">,</span> <span class="token string">'3x + 4'</span><span class="token punctuation">)</span>
<span class="token comment">// [ '3' ]</span>
<span class="token function">tokenize</span><span class="token punctuation">(</span><span class="token constant">TOKEN_G</span><span class="token punctuation">,</span> <span class="token string">'3x + 4'</span><span class="token punctuation">)</span>
<span class="token comment">// [ '3', '+', '4' ]</span>

<span class="token keyword">function</span> <span class="token function">tokenize</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">TOKEN_REGEX</span><span class="token punctuation">,</span> str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> match<span class="token punctuation">;</span>
  <span class="token keyword control-flow">while</span> <span class="token punctuation">(</span>match <span class="token operator">=</span> <span class="token constant">TOKEN_REGEX</span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="s-修饰符：dotall-模式">s 修饰符：dotAll 模式</h3>
<p>正则表达式中，点（.）是一个特殊字符，代表任意的单个字符，但是有两个例外。一个是四个字节的 UTF-16 字符，这个可以用u修饰符解决；另一个是行终止符</p>
<pre><code class="language-js"><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">foo.bar</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'foo\nbar'</span><span class="token punctuation">)</span>
<span class="token comment">// false</span>

<span class="token comment">// es5</span>
<span class="token operator">/</span>foo<span class="token punctuation">[</span><span class="token operator">^</span><span class="token punctuation">]</span>bar<span class="token operator">/</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'foo\nbar'</span><span class="token punctuation">)</span>
<span class="token comment">// true</span>

<span class="token comment">// ES2018 引入s修饰符，使得.可以匹配任意单个字符。</span>
<span class="token operator">/</span>foo<span class="token punctuation">.</span><span class="token property-access">bar</span><span class="token operator">/</span>s<span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'foo\nbar'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre>
<h3 id="后行断言">后行断言</h3>
<pre><code class="language-js"><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;=\$)\d+</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span><span class="token string">'Benjamin Franklin is on the $100 bill'</span><span class="token punctuation">)</span>  <span class="token comment">// ["100"]</span>
<span class="token operator">/</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">!</span>\$<span class="token punctuation">)</span>\d<span class="token operator">+</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span><span class="token string">'it’s is worth about €90'</span><span class="token punctuation">)</span>                <span class="token comment">// ["90"]</span>

<span class="token keyword">const</span> <span class="token constant">RE_DOLLAR_PREFIX</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;=\$)foo</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token string">'$foo %foo foo'</span><span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span><span class="token constant">RE_DOLLAR_PREFIX</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;=(\d+)(\d+))$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span><span class="token string">'1053'</span><span class="token punctuation">)</span> <span class="token comment">// ["", "1", "053"]</span>
<span class="token operator">/</span><span class="token operator">^</span><span class="token punctuation">(</span>\d<span class="token operator">+</span><span class="token punctuation">)</span><span class="token punctuation">(</span>\d<span class="token operator">+</span><span class="token punctuation">)</span>$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span><span class="token string">'1053'</span><span class="token punctuation">)</span> <span class="token comment">// ["1053", "105", "3"]</span>

<span class="token comment">// 后行断言引用必须在之前</span>
<span class="token operator">/</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>d\<span class="token number">1</span><span class="token punctuation">)</span>r<span class="token operator">/</span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span><span class="token string">'hodor'</span><span class="token punctuation">)</span>  <span class="token comment">// null</span>
<span class="token operator">/</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">&lt;=</span>\<span class="token number">1</span><span class="token function">d</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span>r<span class="token operator">/</span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span><span class="token string">'hodor'</span><span class="token punctuation">)</span>  <span class="token comment">// ["r", "o"]</span>
</code></pre>
<h3 id="具名组匹配">具名组匹配</h3>
<pre><code class="language-js"><span class="token comment">// es5</span>
<span class="token keyword">const</span> <span class="token constant">RE_DATE</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(\d{4})-(\d{2})-(\d{2})</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> matchObj <span class="token operator">=</span> <span class="token constant">RE_DATE</span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span><span class="token string">'1999-12-31'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> year <span class="token operator">=</span> matchObj<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 1999</span>
<span class="token keyword">const</span> month <span class="token operator">=</span> matchObj<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 12</span>
<span class="token keyword">const</span> day <span class="token operator">=</span> matchObj<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 31</span>

<span class="token comment">// es6</span>
<span class="token keyword">const</span> <span class="token constant">RE_DATE</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;year>\d{4})-(?&lt;month>\d{2})-(?&lt;day>\d{2})</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> matchObj <span class="token operator">=</span> <span class="token constant">RE_DATE</span><span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span><span class="token string">'1999-12-31'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> year <span class="token operator">=</span> matchObj<span class="token punctuation">.</span><span class="token property-access">groups</span><span class="token punctuation">.</span><span class="token property-access">year</span><span class="token punctuation">;</span> <span class="token comment">// "1999"</span>
<span class="token keyword">const</span> month <span class="token operator">=</span> matchObj<span class="token punctuation">.</span><span class="token property-access">groups</span><span class="token punctuation">.</span><span class="token property-access">month</span><span class="token punctuation">;</span> <span class="token comment">// "12"</span>
<span class="token keyword">const</span> day <span class="token operator">=</span> matchObj<span class="token punctuation">.</span><span class="token property-access">groups</span><span class="token punctuation">.</span><span class="token property-access">day</span><span class="token punctuation">;</span> <span class="token comment">// "31"</span>


<span class="token keyword">let</span> re <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;year>\d{4})-(?&lt;month>\d{2})-(?&lt;day>\d{2})</span><span class="token regex-delimiter">/</span><span class="token regex-flags">u</span></span><span class="token punctuation">;</span>

<span class="token string">'2015-01-02'</span><span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span>re<span class="token punctuation">,</span> <span class="token string">'$&lt;day>/$&lt;month>/$&lt;year>'</span><span class="token punctuation">)</span>
<span class="token comment">// '02/01/2015'</span>


<span class="token string">'2015-01-02'</span><span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span>re<span class="token punctuation">,</span> <span class="token punctuation">(</span>
   matched<span class="token punctuation">,</span> <span class="token comment">// 整个匹配结果 2015-01-02</span>
   capture1<span class="token punctuation">,</span> <span class="token comment">// 第一个组匹配 2015</span>
   capture2<span class="token punctuation">,</span> <span class="token comment">// 第二个组匹配 01</span>
   capture3<span class="token punctuation">,</span> <span class="token comment">// 第三个组匹配 02</span>
   position<span class="token punctuation">,</span> <span class="token comment">// 匹配开始的位置 0</span>
   <span class="token constant">S</span><span class="token punctuation">,</span> <span class="token comment">// 原字符串 2015-01-02</span>
   groups <span class="token comment">// 具名组构成的一个对象 {year, month, day}</span>
 <span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
 <span class="token keyword">let</span> <span class="token punctuation">{</span>day<span class="token punctuation">,</span> month<span class="token punctuation">,</span> year<span class="token punctuation">}</span> <span class="token operator">=</span> groups<span class="token punctuation">;</span>
 <span class="token keyword control-flow">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>day<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>month<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>year<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 引用 </span>
<span class="token keyword">const</span> <span class="token constant">RE_TWICE</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(?&lt;word>[a-z]+)!\k&lt;word>$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token constant">RE_TWICE</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'abc!abc'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token constant">RE_TWICE</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'abc!ab'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>

<span class="token keyword">const</span> <span class="token constant">RE_TWICE</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(?&lt;word>[a-z]+)!\1$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token constant">RE_TWICE</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'abc!abc'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token constant">RE_TWICE</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'abc!ab'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>

<span class="token keyword">const</span> <span class="token constant">RE_TWICE</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(?&lt;word>[a-z]+)!\k&lt;word>!\1$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token constant">RE_TWICE</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'abc!abc!abc'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token constant">RE_TWICE</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token string">'abc!abc!ab'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre>
<h3 id="正则匹配索引">正则匹配索引</h3>
<pre><code class="language-js"><span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token string">'zabbcdef'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> re <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">ab</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>

result<span class="token punctuation">.</span><span class="token property-access">index</span> <span class="token comment">// 1</span>
result<span class="token punctuation">.</span><span class="token property-access">indices</span> <span class="token comment">// [ [1, 3] ]</span>

<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token string">'zabbcdef'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> re <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">ab+(cd)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>

result<span class="token punctuation">.</span><span class="token property-access">indices</span> <span class="token comment">// [ [ 1, 6 ], [ 4, 6 ] ]</span>

<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token string">'zabbcdef'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> re <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">ab+(cd(ef))</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>

result<span class="token punctuation">.</span><span class="token property-access">indices</span> <span class="token comment">// [ [1, 8], [4, 8], [6, 8] ]</span>

<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token string">'zabbcdef'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> re <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">ab+(?&lt;Z>cd)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token method function property-access">exec</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>

result<span class="token punctuation">.</span><span class="token property-access">indices</span><span class="token punctuation">.</span><span class="token property-access">groups</span> <span class="token comment">// { Z: [ 4, 6 ] }</span>
</code></pre>
<h3 id="用-forawaitof-的语法来操作">用 for...await...of 的语法来操作</h3>
<pre><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TimeOut</span></span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function"><span class="token maybe-class-name">TimeOut</span></span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">TimeOut</span></span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">TimeOut</span></span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword control-flow">for</span> <span class="token keyword control-flow">await</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 1560092345730 2000</span>
<span class="token comment">// 1560092345730 1000</span>
<span class="token comment">// 1560092346336 3000</span>
</code></pre>
<h2 id="es10">ES10</h2>
<h3 id="flat-flatmap">flat flatMap</h3>
<pre><code class="language-js"><span class="token keyword">const</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>arr1<span class="token punctuation">.</span><span class="token method function property-access">flat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// expected output: [0, 1, 2, 3, 4]</span>

<span class="token keyword">const</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>arr2<span class="token punctuation">.</span><span class="token method function property-access">flat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// expected output: [0, 1, 2, [3, 4]]</span>

<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">flatMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">[</span><span class="token punctuation">[</span>x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [[2], [4], [6], [8]]</span>
</code></pre>
<h3 id="objectfromentries">Object.fromEntries</h3>
<pre><code class="language-js"><span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">fromEntries</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// { foo: bar, baz: 41 }</span>

<span class="token keyword">const</span> entries <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">fromEntries</span><span class="token punctuation">(</span>entries<span class="token punctuation">)</span>
<span class="token comment">// { foo: bar, baz: 41 }</span>

<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token string">"bar"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">fromEntries</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { foo: true, bar: false }</span>

<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">"0"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">fromEntries</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { 0: "a", 1: "b", 2: "c" }</span>


<span class="token keyword">let</span> query <span class="token operator">=</span> <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">fromEntries</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token string">"foo=bar&amp;baz=qux"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {foo: "bar", baz: "qux"}</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">40</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">36</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">fromEntries</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> age<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {Alice: 40, Bob: 36}</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="symboldescription">Symbol#description</h3>
<pre><code class="language-js"><span class="token keyword">const</span> sym <span class="token operator">=</span> <span class="token known-class-name class-name">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
<span class="token known-class-name class-name">String</span><span class="token punctuation">(</span>sym<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Symbol(foo)"</span>
sym<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Symbol(foo)"</span>
sym<span class="token punctuation">.</span><span class="token property-access">description</span> <span class="token comment">// foo</span>
</code></pre>
<h2 id="es11">ES11</h2>
<h3 id="stringprototypematchall">String.prototype.matchAll</h3>
<p><code>String.prototype.matchAll</code>返回一个正则表达式在当前字符串的所有匹配</p>
<pre><code class="language-js"><span class="token keyword">const</span> string <span class="token operator">=</span> <span class="token string">"test1test2test3"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> regex <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">t(e)(st(\d?))</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> newdata <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token method function property-access">matchAll</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> match <span class="token keyword">of</span> newdata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>match<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ["test1", "e", "st1", "1", index: 0, input: "test1test2test3"]</span>
<span class="token comment">// ["test2", "e", "st2", "2", index: 5, input: "test1test2test3"]</span>
<span class="token comment">// ["test3", "e", "st3", "3", index: 10, input: "test1test2test3"]</span>

<span class="token comment">// 转为数组的方法一</span>
<span class="token punctuation">[</span><span class="token spread operator">...</span>newdata<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 转为数组的方法二</span>
<span class="token known-class-name class-name">Array</span><span class="token punctuation">.</span><span class="token keyword module">from</span><span class="token punctuation">(</span>newdata<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="promise">Promise</h3>
<p><code>Promise</code>静态方法</p>
<ul>
<li><code>Promise.race</code> 只要任意一个 promise 的状态改变(不管成功 or 失败)，那么就返回那个 promise</li>
<li><code>Promise.allSettled</code> 只有等到所有实例都返回结果，不管是fulfilled还是rejected，实例才会结束</li>
<li><code>Promise.any</code> 只要其中任意一个 promise 成功，就返回那个已经成功的 promise。</li>
</ul>
<p><code>Promise</code>实例属性<code>status</code>可以反应成功与否成功为<code>fulfilled</code>，失败为<code>rejected</code>，实例中有<code>finally</code>无论成功与否</p>
<pre><code class="language-js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> promises <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"./index.html"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://does-not-exist/"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">allSettled</span><span class="token punctuation">(</span>promises<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 过滤出成功的请求</span>
  <span class="token keyword">const</span> successfulPromises <span class="token operator">=</span> results
    <span class="token punctuation">.</span><span class="token method function property-access">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> p<span class="token punctuation">.</span><span class="token property-access">status</span> <span class="token operator">===</span> <span class="token string">"fulfilled"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> p<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 过滤出失败的请求，并输出原因</span>
  <span class="token keyword">const</span> errors <span class="token operator">=</span> results
    <span class="token punctuation">.</span><span class="token method function property-access">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> p<span class="token punctuation">.</span><span class="token property-access">status</span> <span class="token operator">===</span> <span class="token string">"rejected"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> p<span class="token punctuation">.</span><span class="token property-access">reason</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">allSettled</span><span class="token punctuation">(</span>requests<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword control-flow">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"所有请求已结束，并且我不关心是成功还是失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 关闭loading状态</span>
  <span class="token function">removeLoadingIndicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="globalthis">globalThis</h3>
<p>globalThis 提供了一个标准的方式来获取不同环境下的全局 this 对象（也就是全局对象自身）</p>
<pre><code class="language-js"><span class="token comment">// 以前：</span>
<span class="token keyword">var</span> <span class="token function-variable function">getGlobal</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> self <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword control-flow">return</span> self<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token dom variable">window</span> <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword control-flow">return</span> <span class="token dom variable">window</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> global <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword control-flow">return</span> global<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword control-flow">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'unable to locate global object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> globals <span class="token operator">=</span> <span class="token function">getGlobal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 现在</span>
globalThis
</code></pre>
<h3 id="空位合并操作符">空位合并操作符(??)</h3>
<p>空值合并操作符(??)只有当左侧为<code>null|undefined</code>事会返回右侧的值</p>
<pre><code class="language-js"><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword null nil">null</span> <span class="token operator">??</span> <span class="token number">1</span>           <span class="token comment">// 1</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword nil">undefined</span> <span class="token operator">??</span> <span class="token number">1</span>      <span class="token comment">// 1</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token string">''</span> <span class="token operator">??</span> <span class="token number">1</span>             <span class="token comment">// ''</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">NaN</span> <span class="token operator">??</span> <span class="token number">1</span>            <span class="token comment">// NaN</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">??</span> <span class="token number">1</span>              <span class="token comment">// 0</span>
</code></pre>
<h3 id="可选链式操作符（）">可选链式操作符（?.）</h3>
<p>?. 也叫链判断运算符。它允许开发人员读取深度嵌套在对象链中的属性值，而不必验证每个引用。当引用为空时，表达式停止计算并返回 undefined。</p>
<pre><code class="language-js"><span class="token keyword">var</span> travelPlans <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">destination</span><span class="token operator">:</span> <span class="token string">"DC"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">monday</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">location</span><span class="token operator">:</span> <span class="token string">"National Mall"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">budget</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// new</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>travelPlans<span class="token punctuation">.</span><span class="token property-access">tuesday</span><span class="token operator">?.</span><span class="token dom variable">location</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => undefined</span>

<span class="token comment">// 可选链不能用于赋值</span>
<span class="token keyword">let</span> object <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
object<span class="token operator">?.</span>property <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// Uncaught SyntaxError: Invalid left-hand side in assignment</span>

<span class="token comment">// old</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> travelPlans<span class="token punctuation">.</span><span class="token property-access">tuesday</span> <span class="token operator">&amp;&amp;</span> travelPlans<span class="token punctuation">.</span><span class="token property-access">tuesday</span><span class="token punctuation">.</span><span class="token property-access">location</span>
</code></pre>
<h3 id="bigint">bigInt</h3>
<p>旧版本的 JS 标准最大的整数只能是 2^53-- 即Number.MAX_SAFE_INTEGER或Math.pow(2, 53)</p>
<p>如果无法准确计算大于2^53的数字的</p>
<p>现在使用BigInt 用来表示整数，没有位数的限制，任何位数的整数都可以精确表示。</p>
<pre><code class="language-js"><span class="token keyword">const</span> theBiggestInt <span class="token operator">=</span> <span class="token number">9007199254740991n</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> alsoHuge <span class="token operator">=</span> <span class="token known-class-name class-name">BigInt</span><span class="token punctuation">(</span><span class="token number">9007199254740991</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="es12">ES12</h2>
<h3 id="stringprotypereplaceall">String.protype.replaceAll</h3>
<pre><code class="language-js"><span class="token comment">// old</span>
<span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">"a+b+c+"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newStr <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"🤣"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>newStr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//a🤣b🤣c🤣</span>

<span class="token comment">// 获取使用 split，join进行字符串分割</span>
<span class="token keyword">const</span> queryString <span class="token operator">=</span> <span class="token string">"q=query+string+parameters"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> withSpaces <span class="token operator">=</span> queryString<span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// new</span>
<span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">"a+b+c+"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newStr <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token method function property-access">replaceAll</span><span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">,</span> <span class="token string">"🤣"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>newStr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//a🤣b🤣c🤣</span>

<span class="token keyword">const</span> queryString <span class="token operator">=</span> <span class="token string">"q=query+string+parameters"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> withSpaces <span class="token operator">=</span> queryString<span class="token punctuation">.</span><span class="token method function property-access">replaceAll</span><span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="weakref-和-finalizationregistry">WeakRef 和 FinalizationRegistry</h3>
<p>WeakRef 提案主要包含两个新功能：</p>
<p>可以通过 WeakRef 类来给某个对象创建一个弱引用<br>可以通过 FinalizationRegistry 类，在某个对象被垃圾回收之后，执行一些自定义方法</p>
<p>WeakRef 主要用来缓存和映射一些大型对象，当你希望某个对象在不被其它地方引用的情况下及时地被垃圾回收，那么你就可以使用它。</p>
<pre><code class="language-js"><span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> finalizationGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FinalizationGroup</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">iterator</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> name <span class="token keyword">of</span> iterator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ref <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// WeakRef 通过 deref方法返回引用对象， 如果被收回则为空</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>ref <span class="token operator">!==</span> <span class="token keyword nil">undefined</span> <span class="token operator">&amp;&amp;</span> ref<span class="token punctuation">.</span><span class="token method function property-access">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token keyword nil">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      cache<span class="token punctuation">.</span><span class="token method function property-access">delete</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getImageCached</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ref <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>ref <span class="token operator">!==</span> <span class="token keyword nil">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 2</span>
    <span class="token comment">// 查看弱引用是否有对象</span>
    <span class="token keyword">const</span> deref <span class="token operator">=</span> ref<span class="token punctuation">.</span><span class="token method function property-access">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>deref <span class="token operator">!==</span> <span class="token keyword nil">undefined</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> deref<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token function">performExpensiveOperation</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>

  <span class="token comment">// 创建weakRef</span>
  <span class="token keyword">const</span> wr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakRef</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
  cache<span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> wr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
  <span class="token comment">// image 注册垃圾回收 传入回调参数</span>
  finalizationGroup<span class="token punctuation">.</span><span class="token method function property-access">register</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span>
  <span class="token keyword control-flow">return</span> image<span class="token punctuation">;</span> <span class="token comment">// 7</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="逻辑赋值运算符">逻辑赋值运算符</h3>
<pre><code class="language-js"><span class="token comment">// better 👶</span>
<span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token parameter">opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Setters are not needlessly called.</span>
  opts<span class="token punctuation">.</span><span class="token property-access">foo</span> <span class="token operator">??=</span> <span class="token string">"bar"</span><span class="token punctuation">;</span>

  <span class="token comment">// No repetition of `opts.baz`.</span>
  opts<span class="token punctuation">.</span><span class="token property-access">baz</span> <span class="token operator">??=</span> <span class="token string">"qux"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 默认参数值</span>
<span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span>opts <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">"foo"</span><span class="token punctuation">,</span> <span class="token literal-property property">baz</span><span class="token operator">:</span> <span class="token string">"baz"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> opts<span class="token punctuation">;</span>
<span class="token punctuation">}</span>




<span class="token keyword">const</span> <span class="token function-variable function">giveKey</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token string">"somekey"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userDetails <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"chika"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token literal-property property">room</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">""</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// userDetails.key = userDetails.key || giveKey();</span>
userDetails<span class="token punctuation">.</span><span class="token property-access">key</span> <span class="token operator">||=</span> <span class="token function">giveKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">.</span><span class="token property-access">key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//output : somekey</span>




<span class="token keyword">const</span> <span class="token function-variable function">deleteKey</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token string">" "</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userDetails <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"chika"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token literal-property property">room</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">"990000"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// userDetails.key = userDetails.key &amp;&amp; deleteKey();</span>
userDetails<span class="token punctuation">.</span><span class="token property-access">key</span> <span class="token operator">&amp;&amp;=</span> <span class="token function">deleteKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">.</span><span class="token property-access">key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//output : ""</span>



<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">// x = x ?? y;</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">??=</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => 5</span>




<span class="token keyword">function</span> <span class="token function">gameSettingsWithNullish</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  options<span class="token punctuation">.</span><span class="token property-access">gameSpeed</span> <span class="token operator">??=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  options<span class="token punctuation">.</span><span class="token property-access">gameDiff</span> <span class="token operator">??=</span> <span class="token string">"easy"</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> options<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">gameSettingsWithDefaultParams</span><span class="token punctuation">(</span>gameSpeed <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> gameDiff <span class="token operator">=</span> <span class="token string">"easy"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span> gameSpeed<span class="token punctuation">,</span> gameDiff <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">gameSettingsWithNullish</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">gameSpeed</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> <span class="token literal-property property">gameDiff</span><span class="token operator">:</span> <span class="token keyword null nil">null</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => {gameSpeed: 1, gameDiff: 'easy'}</span>
<span class="token function">gameSettingsWithDefaultParams</span><span class="token punctuation">(</span><span class="token keyword nil">undefined</span><span class="token punctuation">,</span> <span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => {gameSpeed: 1, gameDiff: null}</span>



<span class="token keyword">const</span> <span class="token function-variable function">getKey</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token string">"somekey"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userDetails <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"chika"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token literal-property property">room</span><span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
userDetails<span class="token punctuation">.</span><span class="token property-access">key</span> <span class="token operator">??=</span> <span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">.</span><span class="token property-access">key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//output : "somekey"</span>
</code></pre>
<h3 id="数字分隔符">数字分隔符</h3>
<p>此功能使开发人员可以通过在数字组之间创建视觉分隔来使其数字文字更具可读性。</p>
<pre><code class="language-js"><span class="token number">1_000_000_000</span><span class="token punctuation">;</span> <span class="token comment">// 十亿</span>
<span class="token number">101_475_938.38</span><span class="token punctuation">;</span> <span class="token comment">// 亿万</span>

<span class="token keyword">const</span> amount <span class="token operator">=</span> <span class="token number">12345_00</span><span class="token punctuation">;</span> <span class="token comment">// 1234500</span>
<span class="token keyword">const</span> amount <span class="token operator">=</span> <span class="token number">123_4500</span><span class="token punctuation">;</span> <span class="token comment">// 1234500</span>
<span class="token keyword">const</span> amount <span class="token operator">=</span> <span class="token number">1_234_500</span><span class="token punctuation">;</span> <span class="token comment">// 1,234,500</span>

<span class="token number">0.000_001</span><span class="token punctuation">;</span> <span class="token comment">// 百万分之一</span>
<span class="token number">1e10_000</span><span class="token punctuation">;</span> <span class="token comment">// 10^10000</span>

<span class="token comment">//</span>
<span class="token keyword">const</span> binary_literals <span class="token operator">=</span> <span class="token number">0b1010_0001_1000_0101</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> hex_literals <span class="token operator">=</span> <span class="token number">0xa0_b0_c0</span><span class="token punctuation">;</span>
<span class="token comment">//</span>
<span class="token keyword">const</span> bigInt_literals <span class="token operator">=</span> <span class="token number">1_000_000_000_000n</span><span class="token punctuation">;</span>
<span class="token comment">//</span>
<span class="token keyword">const</span> octal_literal <span class="token operator">=</span> <span class="token number">0o1234_5670</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="es13">ES13</h2>
<h3 id="class">Class</h3>
<pre><code class="language-js"><span class="token comment">// 可以使用声明式的类字段</span>
<span class="token keyword">class</span> <span class="token class-name">Pokemon</span> <span class="token punctuation">{</span>
  name <span class="token operator">=</span> <span class="token string">"Pikachu"</span><span class="token punctuation">;</span>

  <span class="token function">attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">starter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 私有属性/私有方法 我们将使用# 符号表示类的私有变量</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
  #name <span class="token operator">=</span> <span class="token string">"something"</span><span class="token punctuation">;</span>

  #name2 <span class="token operator">=</span> <span class="token string">"name2"</span><span class="token punctuation">;</span>

  <span class="token comment">// 实例私有方法-只能在此Class内部使用</span>
  <span class="token function">#instancePrivateMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"实例私有方法"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// static字段</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
  <span class="token comment">// 静态私有字段声明-只能在此Class内部使用</span>
  <span class="token keyword">static</span> #staticFieldPrivateName <span class="token operator">=</span> <span class="token string">"静态私有字段声明:真名-王撕葱"</span><span class="token punctuation">;</span>

  <span class="token comment">// 静态公有字段声明</span>
  <span class="token keyword">static</span> staticFieldPublicName <span class="token operator">=</span> <span class="token string">"静态公有字段声明:名-撕葱"</span><span class="token punctuation">;</span>

  <span class="token comment">// 静态公有方法-ES6已支持</span>
  <span class="token keyword">static</span> <span class="token function">staticPublicMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"静态公有方法"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 静态私有方法-只能在此Class内部使用</span>
  <span class="token keyword">static</span> <span class="token function">#staticPrivateMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"#staticPrivateMethod:"</span><span class="token punctuation">,</span> <span class="token string">"静态私有方法"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 私有属性也可以设置 getter 和 setter 方法</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
  #name <span class="token operator">=</span> <span class="token string">"something"</span><span class="token punctuation">;</span>

  #name2 <span class="token operator">=</span> <span class="token string">"name2"</span><span class="token punctuation">;</span>

  <span class="token comment">// 只能在此Class内部使用</span>
  <span class="token keyword">get</span> <span class="token function">#privateGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">#name</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 只能在此Class内部使用</span>
  <span class="token keyword">set</span> <span class="token function">#privateSet</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">#name</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">get</span> <span class="token function">publicGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">#name2</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">set</span> <span class="token function">publicSet</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">#name2</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 静态公有/私有字段</span>
<span class="token keyword">class</span> <span class="token class-name">ColorFinder</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> #red <span class="token operator">=</span> <span class="token string">"#ff0000"</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> #green <span class="token operator">=</span> <span class="token string">"#00ff00"</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> #blue <span class="token operator">=</span> <span class="token string">"#0000ff"</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> <span class="token function">colorName</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">switch</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">"red"</span><span class="token operator">:</span>
        <span class="token keyword control-flow">return</span> <span class="token maybe-class-name">ColorFinder</span><span class="token punctuation">.</span><span class="token property-access">#red</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"blue"</span><span class="token operator">:</span>
        <span class="token keyword control-flow">return</span> <span class="token maybe-class-name">ColorFinder</span><span class="token punctuation">.</span><span class="token property-access">#blue</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"green"</span><span class="token operator">:</span>
        <span class="token keyword control-flow">return</span> <span class="token maybe-class-name">ColorFinder</span><span class="token punctuation">.</span><span class="token property-access">#green</span><span class="token punctuation">;</span>
      <span class="token keyword module">default</span><span class="token operator">:</span>
        <span class="token keyword control-flow">throw</span> <span class="token keyword">new</span> <span class="token class-name">RangeError</span><span class="token punctuation">(</span><span class="token string">"unknown color"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Somehow use colorName</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="顶层-await">顶层 await</h3>
<pre><code class="language-js"><span class="token comment">// awaiting.mjs</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> process <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"./some-module.mjs"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dynamic <span class="token operator">=</span> <span class="token keyword module">import</span><span class="token punctuation">(</span>computedModuleSpecifier<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword module">export</span> <span class="token keyword">const</span> output <span class="token operator">=</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword control-flow">await</span> dynamic<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword module">default</span><span class="token punctuation">,</span> <span class="token keyword control-flow">await</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// usage.mjs</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> output <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"./awaiting.mjs"</span><span class="token punctuation">;</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">outputPlusValue</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword control-flow">return</span> output <span class="token operator">+</span> value <span class="token punctuation">}</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">outputPlusValue</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">outputPlusValue</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</div></div><div class="style_article-loading-layer__3poja"><div class="style_layer__GxMiF"><div style="fill:var(--vice-color);height:64px;width:64px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <circle transform="translate(8 0)" cx="0" cy="16" r="0"> 
    <animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0"
      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="translate(16 0)" cx="0" cy="16" r="0"> 
    <animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0.3"
      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="translate(24 0)" cx="0" cy="16" r="0"> 
    <animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0.6"
      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
  </circle>
</svg>
</div></div></div> </div><div class="style_bottom__29qYA"><p>©2021 - bill-lai 的小站 -<a rel="noreferrer" href="https://github.com/bill-lai/bill-lai.github.io" target="_blank">站点源码</a></p><p>本站使用<a rel="noreferrer" target="_blank" href="https://react.docschina.org/docs/hooks-reference.html#usememo">ReactHook</a><a rel="noreferrer" target="_blank" href="https://www.typescriptlang.org/zh/">TypeScript</a><a rel="noreferrer" target="_blank" href="https://docs.github.com/cn/rest">githubAPI</a><a rel="noreferrer" target="_blank" href="https://simplemde.com/">SimpleMDE</a>制作</p></div></div><div class="style_right-layer__Rm9TS "><div class="style_right__3hdcL"><div class="style_right-content__F68mu"><div class="navigation"><h4 class="style_title__1aA1F">目录列表</h4><ul class="style_top-navs__3vyAr"><li class=""><span>ES6<!-- --> <i class="iconfont icon-arrow_down"></i></span><ul class="style_child-navs__6paad"><li class=""><span>Intl<!-- --> </span></li><li class=""><span>判断是否在模块中<!-- --> </span></li><li class=""><span>Number.EPSILON<!-- --> </span></li><li class=""><span>Math.hypot<!-- --> </span></li></ul></li><li class=""><span>ES7<!-- --> <i class="iconfont icon-arrow_down"></i></span><ul class="style_child-navs__6paad"><li class=""><span>求幂运算符<!-- --> </span></li></ul></li><li class=""><span>ES8<!-- --> <i class="iconfont icon-arrow_down"></i></span><ul class="style_child-navs__6paad"><li class=""><span>String padding<!-- --> </span></li><li class=""><span>Object.getOwnProperDescriptors<!-- --> </span></li><li class=""><span>Atomics<!-- --> </span></li></ul></li><li class=""><span>ES9<!-- --> <i class="iconfont icon-arrow_down"></i></span><ul class="style_child-navs__6paad"><li class=""><span>u 修饰符<!-- --> </span></li><li class=""><span>y修饰符<!-- --> </span></li><li class=""><span>s 修饰符：dotAll 模式<!-- --> </span></li><li class=""><span>后行断言<!-- --> </span></li><li class=""><span>具名组匹配<!-- --> </span></li><li class=""><span>正则匹配索引<!-- --> </span></li><li class=""><span>用 for...await...of 的语法来操作<!-- --> </span></li></ul></li><li class=""><span>ES10<!-- --> <i class="iconfont icon-arrow_down"></i></span><ul class="style_child-navs__6paad"><li class=""><span>flat flatMap<!-- --> </span></li><li class=""><span>Object.fromEntries<!-- --> </span></li><li class=""><span>Symbol#description<!-- --> </span></li></ul></li><li class=""><span>ES11<!-- --> <i class="iconfont icon-arrow_down"></i></span><ul class="style_child-navs__6paad"><li class=""><span>String.prototype.matchAll<!-- --> </span></li><li class=""><span>Promise<!-- --> </span></li><li class=""><span>globalThis<!-- --> </span></li><li class=""><span>空位合并操作符(??)<!-- --> </span></li><li class=""><span>可选链式操作符（?.）<!-- --> </span></li><li class=""><span>bigInt<!-- --> </span></li></ul></li><li class=""><span>ES12<!-- --> <i class="iconfont icon-arrow_down"></i></span><ul class="style_child-navs__6paad"><li class=""><span>String.protype.replaceAll<!-- --> </span></li><li class=""><span>WeakRef 和 FinalizationRegistry<!-- --> </span></li><li class=""><span>逻辑赋值运算符<!-- --> </span></li><li class=""><span>数字分隔符<!-- --> </span></li></ul></li><li class=""><span>ES13<!-- --> <i class="iconfont icon-arrow_down"></i></span><ul class="style_child-navs__6paad"><li class=""><span>Class<!-- --> </span></li><li class=""><span>顶层 await<!-- --> </span></li></ul></li></ul></div></div></div></div></div></div></div></div>
        <script>var globalState = {"article/7342e73b1fe61582335c":{"title":"ES知识点记录","id":"7342e73b1fe61582335c","mtime":1647933463318,"ctime":1647933301705,"issues":{"number":29,"commentsUrl":"https://api.github.com/repos/bill-lai/bill-lai.github.io/issues/29/comments","reactionsUrl":"https://api.github.com/repos/bill-lai/bill-lai.github.io/issues/29/reactions"},"head":null,"foot":null,"dirs":[{"leave":2,"title":"ES6","children":[{"leave":3,"title":"Intl","children":[]},{"leave":3,"title":"判断是否在模块中","children":[]},{"leave":3,"title":"Number.EPSILON","children":[]},{"leave":3,"title":"Math.hypot","children":[]}]},{"leave":2,"title":"ES7","children":[{"leave":3,"title":"求幂运算符","children":[]}]},{"leave":2,"title":"ES8","children":[{"leave":3,"title":"String padding","children":[]},{"leave":3,"title":"Object.getOwnProperDescriptors","children":[]},{"leave":3,"title":"Atomics","children":[]}]},{"leave":2,"title":"ES9","children":[{"leave":3,"title":"u 修饰符","children":[]},{"leave":3,"title":"y修饰符","children":[]},{"leave":3,"title":"s 修饰符：dotAll 模式","children":[]},{"leave":3,"title":"后行断言","children":[]},{"leave":3,"title":"具名组匹配","children":[]},{"leave":3,"title":"正则匹配索引","children":[]},{"leave":3,"title":"用 for...await...of 的语法来操作","children":[]}]},{"leave":2,"title":"ES10","children":[{"leave":3,"title":"flat flatMap","children":[]},{"leave":3,"title":"Object.fromEntries","children":[]},{"leave":3,"title":"Symbol#description","children":[]}]},{"leave":2,"title":"ES11","children":[{"leave":3,"title":"String.prototype.matchAll","children":[]},{"leave":3,"title":"Promise","children":[]},{"leave":3,"title":"globalThis","children":[]},{"leave":3,"title":"空位合并操作符(??)","children":[]},{"leave":3,"title":"可选链式操作符（?.）","children":[]},{"leave":3,"title":"bigInt","children":[]}]},{"leave":2,"title":"ES12","children":[{"leave":3,"title":"String.protype.replaceAll","children":[]},{"leave":3,"title":"WeakRef 和 FinalizationRegistry","children":[]},{"leave":3,"title":"逻辑赋值运算符","children":[]},{"leave":3,"title":"数字分隔符","children":[]}]},{"leave":2,"title":"ES13","children":[{"leave":3,"title":"Class","children":[]},{"leave":3,"title":"顶层 await","children":[]}]}],"body":"<h2 id=\"es6\">ES6</h2>\n<h3 id=\"intl\">Intl</h3>\n<p>对象是 ECMAScript 国际化 API 的一个命名空间，它提供了精确的字符串对比、数字格式化，和日期时间格式化。</p>\n<p>日期格式化</p>\n<pre><code class=\"language-js\"><span class=\"token comment\">// 例如我们希望出现的日期信息格式是：“xxxx年xx月xx日 xx:xx:xx”。</span>\n<span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Intl<span class=\"token punctuation\">.</span>DateTimeFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"zh\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">year</span><span class=\"token operator\">:</span> <span class=\"token string\">\"numeric\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">/* \n        '2-digit'表示一定使用2位数字表示，\n        因此，如果数值不超过10，会自动在前面加0\n  */</span>\n  <span class=\"token literal-property property\">month</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2-digit\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">day</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2-digit\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">hour</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2-digit\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">minute</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2-digit\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">second</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2-digit\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// 设置为false表示我们采用24小时制</span>\n  <span class=\"token literal-property property\">hour12</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">format</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// IE11浏览器下的效果 完全符合我们的预期， - 2021年05月29日 10:15:27</span>\n<span class=\"token comment\">// 但是在Chrome浏览器和Firefox浏览器下，却不是中文的年月日而是斜杠-2021/05/29 10:15:27， 还需要进一步字符处理下</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>数字格式化，</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">Intl<span class=\"token punctuation\">.</span>NumberFormat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">format</span><span class=\"token punctuation\">(</span><span class=\"token number\">12345.6789</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 结果是：\"12,345.679\"</span>\n\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">Intl<span class=\"token punctuation\">.</span>NumberFormat</span><span class=\"token punctuation\">(</span><span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">minimumIntegerDigits</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">format</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 结果是：\"08\"</span>\n\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">Intl<span class=\"token punctuation\">.</span>NumberFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"zh\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">style</span><span class=\"token operator\">:</span> <span class=\"token string\">\"currency\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">currency</span><span class=\"token operator\">:</span> <span class=\"token string\">\"CNY\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">currencyDisplay</span><span class=\"token operator\">:</span> <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">format</span><span class=\"token punctuation\">(</span><span class=\"token number\">12345.6789</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 结果是：\"12,345.68 人民币\"</span>\n\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">Intl<span class=\"token punctuation\">.</span>NumberFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"zh\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">style</span><span class=\"token operator\">:</span> <span class=\"token string\">\"currency\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">currency</span><span class=\"token operator\">:</span> <span class=\"token string\">\"CNY\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">format</span><span class=\"token punctuation\">(</span><span class=\"token number\">12345.6789</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 结果是：\"￥12,345.68 \"</span>\n\n<span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">星期</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Intl<span class=\"token punctuation\">.</span>NumberFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"zh-Hans-CN-u-nu-hanidec\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">format</span><span class=\"token punctuation\">(</span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getDay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 结果是：\"星期五\"</span>\n</code></pre>\n<h3 id=\"判断是否在模块中\">判断是否在模块中</h3>\n<p>模块中顶层的 this 等于 undefined</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> isModuleScript <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span> <span class=\"token operator\">===</span> <span class=\"token keyword nil\">undefined</span>\n</code></pre>\n<h3 id=\"numberepsilon\">Number.EPSILON</h3>\n<p>Number.EPSILON 属性表示 1 与Number可表示的大于 1 的最小的浮点数之间的差值。</p>\n<p>判断数值是否相等</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isEqual</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">target<span class=\"token punctuation\">,</span> origin</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token known-class-name class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">abs</span><span class=\"token punctuation\">(</span>origin <span class=\"token operator\">-</span> target<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token known-class-name class-name\">Number</span><span class=\"token punctuation\">.</span><span class=\"token constant\">EPSILON</span>\n</code></pre>\n<h3 id=\"mathhypot\">Math.hypot</h3>\n<p>计算两数平方开方<code>Math.hypot(3,4) === 5</code></p>\n<h2 id=\"es7\">ES7</h2>\n<h3 id=\"求幂运算符\">求幂运算符</h3>\n<pre><code class=\"language-js\"><span class=\"token comment\">// 2的平方</span>\n<span class=\"token keyword\">let</span> squared <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// same as: 2 * 2   Math.Pow(2,2)</span>\n\n<span class=\"token comment\">// 2的三次方</span>\n<span class=\"token keyword\">let</span> cubed <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// same as: 2 * 2 * 2   Math.Pow(2,3)</span>\n</code></pre>\n<h2 id=\"es8\">ES8</h2>\n<h3 id=\"string-padding\">String padding</h3>\n<p>如果某个字符串不够指定长度，会在头部或尾部补全。padStart()用于头部补全，padEnd()用于尾部补全。</p>\n<pre><code class=\"language-js\"><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"0000000001\"</span>\n<span class=\"token string\">\"12\"</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"0000000012\"</span>\n<span class=\"token string\">\"123456\"</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"0000123456\"</span>\n\n<span class=\"token comment\">// 格式提示</span>\n<span class=\"token string\">\"12\"</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"YYYY-MM-DD\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"YYYY-MM-12\"</span>\n<span class=\"token string\">\"09-12\"</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"YYYY-MM-DD\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"YYYY-09-12\"</span>\n</code></pre>\n<h3 id=\"objectgetownproperdescriptors\">Object.getOwnProperDescriptors</h3>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">shallowClone</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">object</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span>\n  <span class=\"token comment\">// 创建一个新对象</span>\n  <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">create</span><span class=\"token punctuation\">(</span>\n    <span class=\"token comment\">// 返回指定对象的原型</span>\n    <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getPrototypeOf</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// 返回指定对象所有自身属性</span>\n    <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getOwnPropertyDescriptors</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 或者</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">shallowMerge</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">target<span class=\"token punctuation\">,</span> source</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span>\n  <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">defineProperties</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getOwnPropertyDescriptors</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3 id=\"atomics\">Atomics</h3>\n<p>Atomics 对象提供了一组静态方法对 SharedArrayBuffer 和 ArrayBuffer 对象进行原子操作。多线程之间操作数据不会引起混乱的api</p>\n<h2 id=\"es9\">ES9</h2>\n<h3 id=\"u-修饰符\">u 修饰符</h3>\n<p>ES6 对正则表达式添加了u修饰符，含义为“Unicode 模式”，用来正确处理大于\\uFFFF的 Unicode 字符。也就是说，会正确处理四个字节的 UTF-16 编码。</p>\n<pre><code class=\"language-js\"><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^\\uD83D</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">u</span></span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\uD83D\\uDC2A'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// false</span>\n<span class=\"token operator\">/</span><span class=\"token operator\">^</span>\\uD83D<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\uD83D\\uDC2A'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n\n<span class=\"token keyword\">var</span> s <span class=\"token operator\">=</span> <span class=\"token string\">'𠮷'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^.$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token comment\">// false</span>\n<span class=\"token operator\">/</span><span class=\"token operator\">^</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">$</span><span class=\"token operator\">/</span>u<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n\n<span class=\"token comment\">// 新增大括号在u模式下标识一个字符 内放置16进制数</span>\n<span class=\"token operator\">/</span>\\u<span class=\"token punctuation\">{</span><span class=\"token number\">61</span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// false</span>\n<span class=\"token operator\">/</span>\\u<span class=\"token punctuation\">{</span><span class=\"token number\">61</span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span>u<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n<span class=\"token operator\">/</span>\\u<span class=\"token punctuation\">{</span>20BB7<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span>u<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'𠮷'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n\n<span class=\"token operator\">/</span>a<span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'aa'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n<span class=\"token operator\">/</span>a<span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span>u<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'aa'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n<span class=\"token operator\">/</span>𠮷<span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'𠮷𠮷'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// false</span>\n<span class=\"token operator\">/</span>𠮷<span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span>u<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'𠮷𠮷'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n\n<span class=\"token operator\">/</span><span class=\"token operator\">^</span>\\<span class=\"token constant\">S</span>$<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'𠮷'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// false</span>\n<span class=\"token operator\">/</span><span class=\"token operator\">^</span>\\<span class=\"token constant\">S</span>$<span class=\"token operator\">/</span>u<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'𠮷'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">codePointLength</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">text</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> result <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">[\\s\\S]</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">gu</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">return</span> result <span class=\"token operator\">?</span> result<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> s <span class=\"token operator\">=</span> <span class=\"token string\">'𠮷𠮷'</span><span class=\"token punctuation\">;</span>\n\ns<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token comment\">// 4</span>\n<span class=\"token function\">codePointLength</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 2</span>\n</code></pre>\n<h3 id=\"y修饰符\">y修饰符</h3>\n<p>除了u修饰符，ES6 还为正则表达式添加了y修饰符，叫做“粘连”（sticky）修饰符。</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">var</span> s <span class=\"token operator\">=</span> <span class=\"token string\">'aaa_aa_a'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> r1 <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">a+</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> r2 <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">a+</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">y</span></span><span class=\"token punctuation\">;</span>\n\nr1<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token comment\">// [\"aaa\"]</span>\nr2<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token comment\">// [\"aaa\"]</span>\n\nr1<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token comment\">// [\"aa\"]</span>\nr2<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token comment\">// null</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">REGEX</span> <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">a</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">y</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 指定从2号位置开始匹配</span>\n<span class=\"token constant\">REGEX</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">lastIndex</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 不是粘连，匹配失败</span>\n<span class=\"token constant\">REGEX</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xaya'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// null</span>\n\n<span class=\"token comment\">// 指定从3号位置开始匹配</span>\n<span class=\"token constant\">REGEX</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">lastIndex</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 3号位置是粘连，匹配成功</span>\n<span class=\"token keyword\">const</span> match <span class=\"token operator\">=</span> <span class=\"token constant\">REGEX</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xaya'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmatch<span class=\"token punctuation\">.</span><span class=\"token property-access\">index</span> <span class=\"token comment\">// 3</span>\n<span class=\"token constant\">REGEX</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">lastIndex</span> <span class=\"token comment\">// 4</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TOKEN_Y</span> <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\s*(\\+|[0-9]+)\\s*</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">y</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TOKEN_G</span>  <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\s*(\\+|[0-9]+)\\s*</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TOKEN_Y</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3 + 4'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// [ '3', '+', '4' ]</span>\n<span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TOKEN_G</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3 + 4'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// [ '3', '+', '4' ]</span>\n\n<span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TOKEN_Y</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3x + 4'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// [ '3' ]</span>\n<span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TOKEN_G</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3x + 4'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// [ '3', '+', '4' ]</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">TOKEN_REGEX</span><span class=\"token punctuation\">,</span> str</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> match<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">while</span> <span class=\"token punctuation\">(</span>match <span class=\"token operator\">=</span> <span class=\"token constant\">TOKEN_REGEX</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    result<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span>match<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword control-flow\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3 id=\"s-修饰符：dotall-模式\">s 修饰符：dotAll 模式</h3>\n<p>正则表达式中，点（.）是一个特殊字符，代表任意的单个字符，但是有两个例外。一个是四个字节的 UTF-16 字符，这个可以用u修饰符解决；另一个是行终止符</p>\n<pre><code class=\"language-js\"><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">foo.bar</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo\\nbar'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// false</span>\n\n<span class=\"token comment\">// es5</span>\n<span class=\"token operator\">/</span>foo<span class=\"token punctuation\">[</span><span class=\"token operator\">^</span><span class=\"token punctuation\">]</span>bar<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo\\nbar'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// true</span>\n\n<span class=\"token comment\">// ES2018 引入s修饰符，使得.可以匹配任意单个字符。</span>\n<span class=\"token operator\">/</span>foo<span class=\"token punctuation\">.</span><span class=\"token property-access\">bar</span><span class=\"token operator\">/</span>s<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo\\nbar'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n</code></pre>\n<h3 id=\"后行断言\">后行断言</h3>\n<pre><code class=\"language-js\"><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">(?&lt;=\\$)\\d+</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Benjamin Franklin is on the $100 bill'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">// [\"100\"]</span>\n<span class=\"token operator\">/</span><span class=\"token punctuation\">(</span><span class=\"token operator\">?</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>\\$<span class=\"token punctuation\">)</span>\\d<span class=\"token operator\">+</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'it’s is worth about €90'</span><span class=\"token punctuation\">)</span>                <span class=\"token comment\">// [\"90\"]</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">RE_DOLLAR_PREFIX</span> <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">(?&lt;=\\$)foo</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token string\">'$foo %foo foo'</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replace</span><span class=\"token punctuation\">(</span><span class=\"token constant\">RE_DOLLAR_PREFIX</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">(?&lt;=(\\d+)(\\d+))$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1053'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// [\"\", \"1\", \"053\"]</span>\n<span class=\"token operator\">/</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>\\d<span class=\"token operator\">+</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>\\d<span class=\"token operator\">+</span><span class=\"token punctuation\">)</span>$<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1053'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// [\"1053\", \"105\", \"3\"]</span>\n\n<span class=\"token comment\">// 后行断言引用必须在之前</span>\n<span class=\"token operator\">/</span><span class=\"token punctuation\">(</span><span class=\"token operator\">?</span><span class=\"token operator\">&lt;=</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span>d\\<span class=\"token number\">1</span><span class=\"token punctuation\">)</span>r<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hodor'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">// null</span>\n<span class=\"token operator\">/</span><span class=\"token punctuation\">(</span><span class=\"token operator\">?</span><span class=\"token operator\">&lt;=</span>\\<span class=\"token number\">1</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>r<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hodor'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">// [\"r\", \"o\"]</span>\n</code></pre>\n<h3 id=\"具名组匹配\">具名组匹配</h3>\n<pre><code class=\"language-js\"><span class=\"token comment\">// es5</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">RE_DATE</span> <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">(\\d{4})-(\\d{2})-(\\d{2})</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> matchObj <span class=\"token operator\">=</span> <span class=\"token constant\">RE_DATE</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1999-12-31'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> year <span class=\"token operator\">=</span> matchObj<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1999</span>\n<span class=\"token keyword\">const</span> month <span class=\"token operator\">=</span> matchObj<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 12</span>\n<span class=\"token keyword\">const</span> day <span class=\"token operator\">=</span> matchObj<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 31</span>\n\n<span class=\"token comment\">// es6</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">RE_DATE</span> <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">(?&lt;year>\\d{4})-(?&lt;month>\\d{2})-(?&lt;day>\\d{2})</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> matchObj <span class=\"token operator\">=</span> <span class=\"token constant\">RE_DATE</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1999-12-31'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> year <span class=\"token operator\">=</span> matchObj<span class=\"token punctuation\">.</span><span class=\"token property-access\">groups</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">year</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"1999\"</span>\n<span class=\"token keyword\">const</span> month <span class=\"token operator\">=</span> matchObj<span class=\"token punctuation\">.</span><span class=\"token property-access\">groups</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">month</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"12\"</span>\n<span class=\"token keyword\">const</span> day <span class=\"token operator\">=</span> matchObj<span class=\"token punctuation\">.</span><span class=\"token property-access\">groups</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">day</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"31\"</span>\n\n\n<span class=\"token keyword\">let</span> re <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">(?&lt;year>\\d{4})-(?&lt;month>\\d{2})-(?&lt;day>\\d{2})</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">u</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token string\">'2015-01-02'</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replace</span><span class=\"token punctuation\">(</span>re<span class=\"token punctuation\">,</span> <span class=\"token string\">'$&lt;day>/$&lt;month>/$&lt;year>'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// '02/01/2015'</span>\n\n\n<span class=\"token string\">'2015-01-02'</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replace</span><span class=\"token punctuation\">(</span>re<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>\n   matched<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 整个匹配结果 2015-01-02</span>\n   capture1<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 第一个组匹配 2015</span>\n   capture2<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 第二个组匹配 01</span>\n   capture3<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 第三个组匹配 02</span>\n   position<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 匹配开始的位置 0</span>\n   <span class=\"token constant\">S</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 原字符串 2015-01-02</span>\n   groups <span class=\"token comment\">// 具名组构成的一个对象 {year, month, day}</span>\n <span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n <span class=\"token keyword\">let</span> <span class=\"token punctuation\">{</span>day<span class=\"token punctuation\">,</span> month<span class=\"token punctuation\">,</span> year<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> groups<span class=\"token punctuation\">;</span>\n <span class=\"token keyword control-flow\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>day<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>month<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>year<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 引用 </span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">RE_TWICE</span> <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^(?&lt;word>[a-z]+)!\\k&lt;word>$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token constant\">RE_TWICE</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'abc!abc'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n<span class=\"token constant\">RE_TWICE</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'abc!ab'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// false</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">RE_TWICE</span> <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^(?&lt;word>[a-z]+)!\\1$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token constant\">RE_TWICE</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'abc!abc'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n<span class=\"token constant\">RE_TWICE</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'abc!ab'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// false</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">RE_TWICE</span> <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^(?&lt;word>[a-z]+)!\\k&lt;word>!\\1$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token constant\">RE_TWICE</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'abc!abc!abc'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// true</span>\n<span class=\"token constant\">RE_TWICE</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'abc!abc!ab'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// false</span>\n</code></pre>\n<h3 id=\"正则匹配索引\">正则匹配索引</h3>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token string\">'zabbcdef'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> re <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">ab</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nresult<span class=\"token punctuation\">.</span><span class=\"token property-access\">index</span> <span class=\"token comment\">// 1</span>\nresult<span class=\"token punctuation\">.</span><span class=\"token property-access\">indices</span> <span class=\"token comment\">// [ [1, 3] ]</span>\n\n<span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token string\">'zabbcdef'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> re <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">ab+(cd)</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nresult<span class=\"token punctuation\">.</span><span class=\"token property-access\">indices</span> <span class=\"token comment\">// [ [ 1, 6 ], [ 4, 6 ] ]</span>\n\n<span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token string\">'zabbcdef'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> re <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">ab+(cd(ef))</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nresult<span class=\"token punctuation\">.</span><span class=\"token property-access\">indices</span> <span class=\"token comment\">// [ [1, 8], [4, 8], [6, 8] ]</span>\n\n<span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token string\">'zabbcdef'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> re <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">ab+(?&lt;Z>cd)</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exec</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nresult<span class=\"token punctuation\">.</span><span class=\"token property-access\">indices</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">groups</span> <span class=\"token comment\">// { Z: [ 4, 6 ] }</span>\n</code></pre>\n<h3 id=\"用-forawaitof-的语法来操作\">用 for...await...of 的语法来操作</h3>\n<pre><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\"><span class=\"token maybe-class-name\">TimeOut</span></span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\"><span class=\"token maybe-class-name\">TimeOut</span></span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\"><span class=\"token maybe-class-name\">TimeOut</span></span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\"><span class=\"token maybe-class-name\">TimeOut</span></span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword control-flow\">for</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> item <span class=\"token keyword\">of</span> arr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token known-class-name class-name\">Date</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// 1560092345730 2000</span>\n<span class=\"token comment\">// 1560092345730 1000</span>\n<span class=\"token comment\">// 1560092346336 3000</span>\n</code></pre>\n<h2 id=\"es10\">ES10</h2>\n<h3 id=\"flat-flatmap\">flat flatMap</h3>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> arr1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>arr1<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">flat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// expected output: [0, 1, 2, 3, 4]</span>\n\n<span class=\"token keyword\">const</span> arr2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>arr2<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">flat</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// expected output: [0, 1, 2, [3, 4]]</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">flatMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>x <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// [[2], [4], [6], [8]]</span>\n</code></pre>\n<h3 id=\"objectfromentries\">Object.fromEntries</h3>\n<pre><code class=\"language-js\"><span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">fromEntries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">'baz'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// { foo: bar, baz: 41 }</span>\n\n<span class=\"token keyword\">const</span> entries <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">'baz'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">fromEntries</span><span class=\"token punctuation\">(</span>entries<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// { foo: bar, baz: 41 }</span>\n\n<span class=\"token keyword\">const</span> map <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"foo\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bar\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">fromEntries</span><span class=\"token punctuation\">(</span>map<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// { foo: true, bar: false }</span>\n\n<span class=\"token keyword\">const</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"0\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">fromEntries</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// { 0: \"a\", 1: \"b\", 2: \"c\" }</span>\n\n\n<span class=\"token keyword\">let</span> query <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">fromEntries</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">URLSearchParams</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"foo=bar&amp;baz=qux\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// {foo: \"bar\", baz: \"qux\"}</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Alice\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token number\">40</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Bob\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token number\">36</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> obj <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">fromEntries</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">,</span> age <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// {Alice: 40, Bob: 36}</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3 id=\"symboldescription\">Symbol#description</h3>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> sym <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">)</span>\n<span class=\"token known-class-name class-name\">String</span><span class=\"token punctuation\">(</span>sym<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Symbol(foo)\"</span>\nsym<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Symbol(foo)\"</span>\nsym<span class=\"token punctuation\">.</span><span class=\"token property-access\">description</span> <span class=\"token comment\">// foo</span>\n</code></pre>\n<h2 id=\"es11\">ES11</h2>\n<h3 id=\"stringprototypematchall\">String.prototype.matchAll</h3>\n<p><code>String.prototype.matchAll</code>返回一个正则表达式在当前字符串的所有匹配</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> string <span class=\"token operator\">=</span> <span class=\"token string\">\"test1test2test3\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> regex <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">t(e)(st(\\d?))</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> newdata <span class=\"token operator\">=</span> string<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">matchAll</span><span class=\"token punctuation\">(</span>regex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword control-flow\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> match <span class=\"token keyword\">of</span> newdata<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>match<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// [\"test1\", \"e\", \"st1\", \"1\", index: 0, input: \"test1test2test3\"]</span>\n<span class=\"token comment\">// [\"test2\", \"e\", \"st2\", \"2\", index: 5, input: \"test1test2test3\"]</span>\n<span class=\"token comment\">// [\"test3\", \"e\", \"st3\", \"3\", index: 10, input: \"test1test2test3\"]</span>\n\n<span class=\"token comment\">// 转为数组的方法一</span>\n<span class=\"token punctuation\">[</span><span class=\"token spread operator\">...</span>newdata<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 转为数组的方法二</span>\n<span class=\"token known-class-name class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token keyword module\">from</span><span class=\"token punctuation\">(</span>newdata<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3 id=\"promise\">Promise</h3>\n<p><code>Promise</code>静态方法</p>\n<ul>\n<li><code>Promise.race</code> 只要任意一个 promise 的状态改变(不管成功 or 失败)，那么就返回那个 promise</li>\n<li><code>Promise.allSettled</code> 只有等到所有实例都返回结果，不管是fulfilled还是rejected，实例才会结束</li>\n<li><code>Promise.any</code> 只要其中任意一个 promise 成功，就返回那个已经成功的 promise。</li>\n</ul>\n<p><code>Promise</code>实例属性<code>status</code>可以反应成功与否成功为<code>fulfilled</code>，失败为<code>rejected</code>，实例中有<code>finally</code>无论成功与否</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> promises <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./index.html\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://does-not-exist/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> results <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token known-class-name class-name\">Promise</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">allSettled</span><span class=\"token punctuation\">(</span>promises<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 过滤出成功的请求</span>\n  <span class=\"token keyword\">const</span> successfulPromises <span class=\"token operator\">=</span> results\n    <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> p<span class=\"token punctuation\">.</span><span class=\"token property-access\">status</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"fulfilled\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> p<span class=\"token punctuation\">.</span><span class=\"token property-access\">value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 过滤出失败的请求，并输出原因</span>\n  <span class=\"token keyword\">const</span> errors <span class=\"token operator\">=</span> results\n    <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> p<span class=\"token punctuation\">.</span><span class=\"token property-access\">status</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"rejected\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> p<span class=\"token punctuation\">.</span><span class=\"token property-access\">reason</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>errors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token known-class-name class-name\">Promise</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">allSettled</span><span class=\"token punctuation\">(</span>requests<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword control-flow\">finally</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"所有请求已结束，并且我不关心是成功还是失败\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 关闭loading状态</span>\n  <span class=\"token function\">removeLoadingIndicator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3 id=\"globalthis\">globalThis</h3>\n<p>globalThis 提供了一个标准的方式来获取不同环境下的全局 this 对象（也就是全局对象自身）</p>\n<pre><code class=\"language-js\"><span class=\"token comment\">// 以前：</span>\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">getGlobal</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> self <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword control-flow\">return</span> self<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> <span class=\"token dom variable\">window</span> <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword control-flow\">return</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> global <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword control-flow\">return</span> global<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword control-flow\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'unable to locate global object'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> globals <span class=\"token operator\">=</span> <span class=\"token function\">getGlobal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 现在</span>\nglobalThis\n</code></pre>\n<h3 id=\"空位合并操作符\">空位合并操作符(??)</h3>\n<p>空值合并操作符(??)只有当左侧为<code>null|undefined</code>事会返回右侧的值</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token keyword null nil\">null</span> <span class=\"token operator\">??</span> <span class=\"token number\">1</span>           <span class=\"token comment\">// 1</span>\n<span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token keyword nil\">undefined</span> <span class=\"token operator\">??</span> <span class=\"token number\">1</span>      <span class=\"token comment\">// 1</span>\n<span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token string\">''</span> <span class=\"token operator\">??</span> <span class=\"token number\">1</span>             <span class=\"token comment\">// ''</span>\n<span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token number\">NaN</span> <span class=\"token operator\">??</span> <span class=\"token number\">1</span>            <span class=\"token comment\">// NaN</span>\n<span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token operator\">??</span> <span class=\"token number\">1</span>              <span class=\"token comment\">// 0</span>\n</code></pre>\n<h3 id=\"可选链式操作符（）\">可选链式操作符（?.）</h3>\n<p>?. 也叫链判断运算符。它允许开发人员读取深度嵌套在对象链中的属性值，而不必验证每个引用。当引用为空时，表达式停止计算并返回 undefined。</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">var</span> travelPlans <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">destination</span><span class=\"token operator\">:</span> <span class=\"token string\">\"DC\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">monday</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">location</span><span class=\"token operator\">:</span> <span class=\"token string\">\"National Mall\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">budget</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// new</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>travelPlans<span class=\"token punctuation\">.</span><span class=\"token property-access\">tuesday</span><span class=\"token operator\">?.</span><span class=\"token dom variable\">location</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => undefined</span>\n\n<span class=\"token comment\">// 可选链不能用于赋值</span>\n<span class=\"token keyword\">let</span> object <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nobject<span class=\"token operator\">?.</span>property <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Uncaught SyntaxError: Invalid left-hand side in assignment</span>\n\n<span class=\"token comment\">// old</span>\n<span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> travelPlans<span class=\"token punctuation\">.</span><span class=\"token property-access\">tuesday</span> <span class=\"token operator\">&amp;&amp;</span> travelPlans<span class=\"token punctuation\">.</span><span class=\"token property-access\">tuesday</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">location</span>\n</code></pre>\n<h3 id=\"bigint\">bigInt</h3>\n<p>旧版本的 JS 标准最大的整数只能是 2^53-- 即Number.MAX_SAFE_INTEGER或Math.pow(2, 53)</p>\n<p>如果无法准确计算大于2^53的数字的</p>\n<p>现在使用BigInt 用来表示整数，没有位数的限制，任何位数的整数都可以精确表示。</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> theBiggestInt <span class=\"token operator\">=</span> <span class=\"token number\">9007199254740991n</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> alsoHuge <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">BigInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">9007199254740991</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2 id=\"es12\">ES12</h2>\n<h3 id=\"stringprotypereplaceall\">String.protype.replaceAll</h3>\n<pre><code class=\"language-js\"><span class=\"token comment\">// old</span>\n<span class=\"token keyword\">const</span> str <span class=\"token operator\">=</span> <span class=\"token string\">\"a+b+c+\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> newStr <span class=\"token operator\">=</span> str<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\+</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"🤣\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>newStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//a🤣b🤣c🤣</span>\n\n<span class=\"token comment\">// 获取使用 split，join进行字符串分割</span>\n<span class=\"token keyword\">const</span> queryString <span class=\"token operator\">=</span> <span class=\"token string\">\"q=query+string+parameters\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> withSpaces <span class=\"token operator\">=</span> queryString<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// new</span>\n<span class=\"token keyword\">const</span> str <span class=\"token operator\">=</span> <span class=\"token string\">\"a+b+c+\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> newStr <span class=\"token operator\">=</span> str<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replaceAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"+\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"🤣\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>newStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//a🤣b🤣c🤣</span>\n\n<span class=\"token keyword\">const</span> queryString <span class=\"token operator\">=</span> <span class=\"token string\">\"q=query+string+parameters\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> withSpaces <span class=\"token operator\">=</span> queryString<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replaceAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"+\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3 id=\"weakref-和-finalizationregistry\">WeakRef 和 FinalizationRegistry</h3>\n<p>WeakRef 提案主要包含两个新功能：</p>\n<p>可以通过 WeakRef 类来给某个对象创建一个弱引用<br>可以通过 FinalizationRegistry 类，在某个对象被垃圾回收之后，执行一些自定义方法</p>\n<p>WeakRef 主要用来缓存和映射一些大型对象，当你希望某个对象在不被其它地方引用的情况下及时地被垃圾回收，那么你就可以使用它。</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> cache <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> finalizationGroup <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FinalizationGroup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">iterator</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> name <span class=\"token keyword\">of</span> iterator<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> cache<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">get</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// WeakRef 通过 deref方法返回引用对象， 如果被收回则为空</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>ref <span class=\"token operator\">!==</span> <span class=\"token keyword nil\">undefined</span> <span class=\"token operator\">&amp;&amp;</span> ref<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">deref</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      cache<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">delete</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getImageCached</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> cache<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">get</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>ref <span class=\"token operator\">!==</span> <span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 2</span>\n    <span class=\"token comment\">// 查看弱引用是否有对象</span>\n    <span class=\"token keyword\">const</span> deref <span class=\"token operator\">=</span> ref<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">deref</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>deref <span class=\"token operator\">!==</span> <span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token keyword control-flow\">return</span> deref<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> image <span class=\"token operator\">=</span> <span class=\"token function\">performExpensiveOperation</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 3</span>\n\n  <span class=\"token comment\">// 创建weakRef</span>\n  <span class=\"token keyword\">const</span> wr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WeakRef</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 4</span>\n  cache<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">set</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> wr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 5</span>\n  <span class=\"token comment\">// image 注册垃圾回收 传入回调参数</span>\n  finalizationGroup<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">register</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 6</span>\n  <span class=\"token keyword control-flow\">return</span> image<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 7</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3 id=\"逻辑赋值运算符\">逻辑赋值运算符</h3>\n<pre><code class=\"language-js\"><span class=\"token comment\">// better 👶</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">example</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">opts</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Setters are not needlessly called.</span>\n  opts<span class=\"token punctuation\">.</span><span class=\"token property-access\">foo</span> <span class=\"token operator\">??=</span> <span class=\"token string\">\"bar\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// No repetition of `opts.baz`.</span>\n  opts<span class=\"token punctuation\">.</span><span class=\"token property-access\">baz</span> <span class=\"token operator\">??=</span> <span class=\"token string\">\"qux\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 默认参数值</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">example</span><span class=\"token punctuation\">(</span>opts <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">foo</span><span class=\"token operator\">:</span> <span class=\"token string\">\"foo\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">baz</span><span class=\"token operator\">:</span> <span class=\"token string\">\"baz\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> opts<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">giveKey</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token string\">\"somekey\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> userDetails <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"chika\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">room</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">key</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// userDetails.key = userDetails.key || giveKey();</span>\nuserDetails<span class=\"token punctuation\">.</span><span class=\"token property-access\">key</span> <span class=\"token operator\">||=</span> <span class=\"token function\">giveKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>userDetails<span class=\"token punctuation\">.</span><span class=\"token property-access\">key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//output : somekey</span>\n\n\n\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">deleteKey</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token string\">\" \"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> userDetails <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"chika\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">room</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">key</span><span class=\"token operator\">:</span> <span class=\"token string\">\"990000\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// userDetails.key = userDetails.key &amp;&amp; deleteKey();</span>\nuserDetails<span class=\"token punctuation\">.</span><span class=\"token property-access\">key</span> <span class=\"token operator\">&amp;&amp;=</span> <span class=\"token function\">deleteKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>userDetails<span class=\"token punctuation\">.</span><span class=\"token property-access\">key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//output : \"\"</span>\n\n\n\n<span class=\"token keyword\">var</span> x <span class=\"token operator\">=</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> y <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// x = x ?? y;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">??=</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => 5</span>\n\n\n\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">gameSettingsWithNullish</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">options</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  options<span class=\"token punctuation\">.</span><span class=\"token property-access\">gameSpeed</span> <span class=\"token operator\">??=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  options<span class=\"token punctuation\">.</span><span class=\"token property-access\">gameDiff</span> <span class=\"token operator\">??=</span> <span class=\"token string\">\"easy\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">return</span> options<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">gameSettingsWithDefaultParams</span><span class=\"token punctuation\">(</span>gameSpeed <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> gameDiff <span class=\"token operator\">=</span> <span class=\"token string\">\"easy\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span> gameSpeed<span class=\"token punctuation\">,</span> gameDiff <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">gameSettingsWithNullish</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">gameSpeed</span><span class=\"token operator\">:</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">gameDiff</span><span class=\"token operator\">:</span> <span class=\"token keyword null nil\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => {gameSpeed: 1, gameDiff: 'easy'}</span>\n<span class=\"token function\">gameSettingsWithDefaultParams</span><span class=\"token punctuation\">(</span><span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => {gameSpeed: 1, gameDiff: null}</span>\n\n\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getKey</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token string\">\"somekey\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> userDetails <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"chika\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">room</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nuserDetails<span class=\"token punctuation\">.</span><span class=\"token property-access\">key</span> <span class=\"token operator\">??=</span> <span class=\"token function\">getKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>userDetails<span class=\"token punctuation\">.</span><span class=\"token property-access\">key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//output : \"somekey\"</span>\n</code></pre>\n<h3 id=\"数字分隔符\">数字分隔符</h3>\n<p>此功能使开发人员可以通过在数字组之间创建视觉分隔来使其数字文字更具可读性。</p>\n<pre><code class=\"language-js\"><span class=\"token number\">1_000_000_000</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 十亿</span>\n<span class=\"token number\">101_475_938.38</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 亿万</span>\n\n<span class=\"token keyword\">const</span> amount <span class=\"token operator\">=</span> <span class=\"token number\">12345_00</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1234500</span>\n<span class=\"token keyword\">const</span> amount <span class=\"token operator\">=</span> <span class=\"token number\">123_4500</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1234500</span>\n<span class=\"token keyword\">const</span> amount <span class=\"token operator\">=</span> <span class=\"token number\">1_234_500</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1,234,500</span>\n\n<span class=\"token number\">0.000_001</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 百万分之一</span>\n<span class=\"token number\">1e10_000</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 10^10000</span>\n\n<span class=\"token comment\">//</span>\n<span class=\"token keyword\">const</span> binary_literals <span class=\"token operator\">=</span> <span class=\"token number\">0b1010_0001_1000_0101</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> hex_literals <span class=\"token operator\">=</span> <span class=\"token number\">0xa0_b0_c0</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//</span>\n<span class=\"token keyword\">const</span> bigInt_literals <span class=\"token operator\">=</span> <span class=\"token number\">1_000_000_000_000n</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//</span>\n<span class=\"token keyword\">const</span> octal_literal <span class=\"token operator\">=</span> <span class=\"token number\">0o1234_5670</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2 id=\"es13\">ES13</h2>\n<h3 id=\"class\">Class</h3>\n<pre><code class=\"language-js\"><span class=\"token comment\">// 可以使用声明式的类字段</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Pokemon</span> <span class=\"token punctuation\">{</span>\n  name <span class=\"token operator\">=</span> <span class=\"token string\">\"Pikachu\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">attack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">static</span> <span class=\"token function\">starter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 私有属性/私有方法 我们将使用# 符号表示类的私有变量</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Student</span> <span class=\"token punctuation\">{</span>\n  #name <span class=\"token operator\">=</span> <span class=\"token string\">\"something\"</span><span class=\"token punctuation\">;</span>\n\n  #name2 <span class=\"token operator\">=</span> <span class=\"token string\">\"name2\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 实例私有方法-只能在此Class内部使用</span>\n  <span class=\"token function\">#instancePrivateMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"实例私有方法\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// static字段</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Student</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 静态私有字段声明-只能在此Class内部使用</span>\n  <span class=\"token keyword\">static</span> #staticFieldPrivateName <span class=\"token operator\">=</span> <span class=\"token string\">\"静态私有字段声明:真名-王撕葱\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 静态公有字段声明</span>\n  <span class=\"token keyword\">static</span> staticFieldPublicName <span class=\"token operator\">=</span> <span class=\"token string\">\"静态公有字段声明:名-撕葱\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 静态公有方法-ES6已支持</span>\n  <span class=\"token keyword\">static</span> <span class=\"token function\">staticPublicMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"静态公有方法\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 静态私有方法-只能在此Class内部使用</span>\n  <span class=\"token keyword\">static</span> <span class=\"token function\">#staticPrivateMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#staticPrivateMethod:\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"静态私有方法\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 私有属性也可以设置 getter 和 setter 方法</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Student</span> <span class=\"token punctuation\">{</span>\n  #name <span class=\"token operator\">=</span> <span class=\"token string\">\"something\"</span><span class=\"token punctuation\">;</span>\n\n  #name2 <span class=\"token operator\">=</span> <span class=\"token string\">\"name2\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 只能在此Class内部使用</span>\n  <span class=\"token keyword\">get</span> <span class=\"token function\">#privateGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">#name</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 只能在此Class内部使用</span>\n  <span class=\"token keyword\">set</span> <span class=\"token function\">#privateSet</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">#name</span> <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">get</span> <span class=\"token function\">publicGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">#name2</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">set</span> <span class=\"token function\">publicSet</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">#name2</span> <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 静态公有/私有字段</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ColorFinder</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">static</span> #red <span class=\"token operator\">=</span> <span class=\"token string\">\"#ff0000\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">static</span> #green <span class=\"token operator\">=</span> <span class=\"token string\">\"#00ff00\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">static</span> #blue <span class=\"token operator\">=</span> <span class=\"token string\">\"#0000ff\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">static</span> <span class=\"token function\">colorName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">switch</span> <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">\"red\"</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword control-flow\">return</span> <span class=\"token maybe-class-name\">ColorFinder</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">#red</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">\"blue\"</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword control-flow\">return</span> <span class=\"token maybe-class-name\">ColorFinder</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">#blue</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">\"green\"</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword control-flow\">return</span> <span class=\"token maybe-class-name\">ColorFinder</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">#green</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword module\">default</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword control-flow\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RangeError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unknown color\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Somehow use colorName</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3 id=\"顶层-await\">顶层 await</h3>\n<pre><code class=\"language-js\"><span class=\"token comment\">// awaiting.mjs</span>\n<span class=\"token keyword module\">import</span> <span class=\"token imports\"><span class=\"token punctuation\">{</span> process <span class=\"token punctuation\">}</span></span> <span class=\"token keyword module\">from</span> <span class=\"token string\">\"./some-module.mjs\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> dynamic <span class=\"token operator\">=</span> <span class=\"token keyword module\">import</span><span class=\"token punctuation\">(</span>computedModuleSpecifier<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword module\">export</span> <span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> <span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword control-flow\">await</span> dynamic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword module\">default</span><span class=\"token punctuation\">,</span> <span class=\"token keyword control-flow\">await</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// usage.mjs</span>\n<span class=\"token keyword module\">import</span> <span class=\"token imports\"><span class=\"token punctuation\">{</span> output <span class=\"token punctuation\">}</span></span> <span class=\"token keyword module\">from</span> <span class=\"token string\">\"./awaiting.mjs\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword module\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">outputPlusValue</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword control-flow\">return</span> output <span class=\"token operator\">+</span> value <span class=\"token punctuation\">}</span>\n\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">outputPlusValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">outputPlusValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n","desc":"ES6\nIntl\n对象是 ECMAScript 国际化 API 的一个命名空间，它提供了精确的字符串对比、数字格式化，和日期时间格式化。\n日期格式化\n// 例如我们希望出现的日期信息格式是：“xxxx年xx月xx日 xx:xx:xx”。\nconst res = new Intl.DateTimeFo"}}</script><script>!function(e){function t(t){for(var n,o,i=t[0],c=t[1],l=t[2],s=0,p=[];s<i.length;s++)o=i[s],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(f&&f(t);p.length;)p.shift()();return u.push.apply(u,l||[]),r()}function r(){for(var e,t=0;t<u.length;t++){for(var r=u[t],n=!0,o=1;o<r.length;o++){var c=r[o];0!==a[c]&&(n=!1)}n&&(u.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},o={1:0},a={1:0},u=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[];o[e]?t.push(o[e]):0!==o[e]&&{4:1}[e]&&t.push(o[e]=new Promise((function(t,r){for(var n="static/css/"+({}[e]||e)+"."+{3:"31d6cfe0",4:"4422e775"}[e]+".chunk.css",a=i.p+n,u=document.getElementsByTagName("link"),c=0;c<u.length;c++){var l=(f=u[c]).getAttribute("data-href")||f.getAttribute("href");if("stylesheet"===f.rel&&(l===n||l===a))return t()}var s=document.getElementsByTagName("style");for(c=0;c<s.length;c++){var f;if((l=(f=s[c]).getAttribute("data-href"))===n||l===a)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var n=t&&t.target&&t.target.src||a,u=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");u.code="CSS_CHUNK_LOAD_FAILED",u.request=n,delete o[e],p.parentNode.removeChild(p),r(u)},p.href=a,document.getElementsByTagName("head")[0].appendChild(p)})).then((function(){o[e]=0})));var r=a[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,n){r=a[e]=[t,n]}));t.push(r[2]=n);var u,c=document.createElement("script");c.charset="utf-8",c.timeout=120,i.nc&&c.setAttribute("nonce",i.nc),c.src=function(e){return i.p+"static/js/"+({}[e]||e)+"."+{3:"c6f781a0",4:"199baeb9"}[e]+".chunk.js"}(e);var l=new Error;u=function(t){c.onerror=c.onload=null,clearTimeout(s);var r=a[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",l.name="ChunkLoadError",l.type=n,l.request=o,r[1](l)}a[e]=void 0}};var s=setTimeout((function(){u({type:"timeout",target:c})}),12e4);c.onerror=c.onload=u,document.head.appendChild(c)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var c=this.webpackJsonpsource=this.webpackJsonpsource||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var f=l;r()}([])</script><script src="/static/js/2.b25e0f2c.chunk.js"></script><script src="/static/js/main.18e76180.chunk.js"></script></body></html>